using System;
using System.Linq;
using Analys.Vector;
using Aryth.Bounds;
using NUnit.Framework;
using Spare;
using Veho;
using Veho.Tuple;

namespace Analys.Test.Histogram {
  [TestFixture]
  public class HistogramTest {
    public static double[] GDPPCs = {
                                      190713.88,
                                      200341.99,
                                      162034.63,
                                      94458.57,
                                      103793.02,
                                      162079.67,
                                      145655.80,
                                      183555.12,
                                      122797.51,
                                      137535.07,
                                      106156.84,
                                      153035.87,
                                      135501.01,
                                      131552.83,
                                      92419.61,
                                      88795.23,
                                      91450.70,
                                      67128.79,
                                      110177.27,
                                      76930.09,
                                      56762.01,
                                      102552.71,
                                      61507.47,
                                      82868.47,
                                      101043.50,
                                      107052.74,
                                      78982.18,
                                      92713.43,
                                      80227.23,
                                      72626.61,
                                      96186.04,
                                      190948.80,
                                      206335.64,
                                      138983.70,
                                      137091.23,
                                      152547.78,
                                      109592.12,
                                      143970.70,
                                      188520.74,
                                      118521.93,
                                      98690.91,
                                      90201.47,
                                      145546.42,
                                      80760.35,
                                      161977.35,
                                      110676.11,
                                      196107.41,
                                      127228.43,
                                      149406.52,
                                      93451.33,
                                      55536.89,
                                      84345.03,
                                      265818.15,
                                      110746.78,
                                      146845.66,
                                      113031.37,
                                      80169.37,
                                      93214.77,
                                      66538.85,
                                      163368.82,
                                      110146.05,
                                      127073.17,
                                      93884.80,
                                      51247.76,
                                      69757.60,
                                      47552.47,
                                      96937.67,
                                      51415.26,
                                      60700.22,
                                      88398.09,
                                      84130.06,
                                      47216.89,
                                      94859.25,
                                      155594.07,
                                      170886.48,
                                      63716.21,
                                      70342.43,
                                      82456.72,
                                      88347.19,
                                      83411.10,
                                      117641.37,
                                      43877.95,
                                      63916.19,
                                      176507.92,
                                      86900.54,
                                      120637.83,
                                      82430.49,
                                      68257.19,
                                      53921.45,
                                      93382.96,
                                      85524.54,
                                      94750.85,
                                      41046.19,
                                      65661.57,
                                      120417.44,
                                      69772.82,
                                      52858.45,
                                      54291.27,
                                      61542.31,
                                      40826.68,
                                      122163.48,
                                      42208.02,
                                      47214.96,
                                      51836.36,
                                      56989.84,
                                      61371.54,
                                      79590.93,
                                      74342.91,
                                      67085.06,
                                      95990.31,
                                      87096.21,
                                      122488.80,
                                      49577.47,
                                      65594.10,
                                      49820.04,
                                      69256.50,
                                      69039.58,
                                      104968.83,
                                      89312.54,
                                      67641.46,
                                      66342.63,
                                      84023.03,
                                      101448.18,
                                      61843.71,
                                      49283.83,
                                      42560.07,
                                      63943.23,
                                      54825.75,
                                      49473.00,
                                      118508.69,
                                      36809.67,
                                      112589.99,
                                      53987.86,
                                      50914.39,
                                      48522.08,
                                      45894.41,
                                      77624.48,
                                      43396.99,
                                      80546.44,
                                      70200.27,
                                      74506.66,
                                      106577.44,
                                      49377.98,
                                      59194.70,
                                      33774.26,
                                      43235.85,
                                      100557.42,
                                      89190.25,
                                      85628.06,
                                      46230.01,
                                      138449.48,
                                      63400.03,
                                      44673.39,
                                      47653.82,
                                      54923.77,
                                      37685.56,
                                      56316.16,
                                      56310.89,
                                      92803.49,
                                      53194.92,
                                      63943.79,
                                      48262.16,
                                      179555.56,
                                      61596.70,
                                      83531.51,
                                      56856.94,
                                      60501.50,
                                      64588.30,
                                      52937.42,
                                      78107.36,
                                      59108.83,
                                      78232.46,
                                      43102.17,
                                      59919.81,
                                      45316.21,
                                      68831.86,
                                      60370.97,
                                      55501.60,
                                      49441.62,
                                      51931.78,
                                      45224.07,
                                      77025.30,
                                      69523.83,
                                      76557.85,
                                      58218.75,
                                      51863.21,
                                      93084.00,
                                      71389.48,
                                      58662.61,
                                      52378.21,
                                      61867.60,
                                      82296.02,
                                      57800.31,
                                      33221.26,
                                      56636.73,
                                      56762.86,
                                      52910.47,
                                      106853.52,
                                      72835.17,
                                      44889.03,
                                      60323.01,
                                      36125.68,
                                      51633.90,
                                      51968.26,
                                      96775.00,
                                      46383.60,
                                      46710.93,
                                      33467.57,
                                      52658.78,
                                      43536.62,
                                      64715.66,
                                      42337.00,
                                      54362.10,
                                      53337.81,
                                      36506.74,
                                      99646.72,
                                      70025.64,
                                      52670.83,
                                      47444.14,
                                      35635.03,
                                      65986.99,
                                      33703.99,
                                      107220.39,
                                      110940.47,
                                      51333.25,
                                      118188.01,
                                      104912.70,
                                      258829.57,
                                      52323.74,
                                      47513.27,
                                      34016.53,
                                      94527.29,
                                      50382.64,
                                      74059.69,
                                      105850.08,
                                      51951.56,
                                      34122.18,
                                      76508.96,
                                      63669.84,
                                      53661.77,
                                      83750.00,
                                      50980.82,
                                      44811.24,
                                      46029.96,
                                      66495.00,
                                      46885.27,
                                      79085.41,
                                      37301.64,
                                      97782.08,
                                      65708.47,
                                      44918.47,
                                      70483.60,
                                      102174.22,
                                      76477.77,
                                      146671.64,
                                      47233.13,
                                      39079.07,
                                      91128.62,
                                      76637.73,
                                      86193.69,
                                      42890.59,
                                      53152.30,
                                      44669.19,
                                      38643.49,
                                      43258.80,
                                      86288.10,
                                      44667.92,
                                      64498.61,
                                      41316.24,
                                      56928.06,
                                      46104.76,
                                      29000.14,
                                      176963.68,
                                      33557.50,
                                      29356.66,
                                      33432.44,
                                      58138.38,
                                      127297.39,
                                      48998.69,
                                      50343.84,
                                      92974.20,
                                      44757.34,
                                      54259.29,
                                      36684.22,
                                      52805.76,
                                      45245.00,
                                      50197.06,
                                      40817.82,
                                      54281.76,
                                      25227.07,
                                      37160.49,
                                      23948.44,
                                      45062.83,
                                      40016.88,
                                      54681.60,
                                      34681.67,
                                      42814.02,
                                      130692.91,
                                      61032.88,
                                      79514.24,
                                      46222.22,
                                      20760.82,
                                      53931.55,
                                      46541.25,
                                      105022.96,
                                      72429.79,
                                      61140.95,
                                      20700.53,
                                      37947.74,
                                      64281.35,
                                      50742.15,
                                      150520.45,
                                      44604.65,
                                      120961.11,
                                      42684.96,
                                      44023.34,
                                      77682.86,
                                      79088.23,
                                      39415.29,
                                      48001.83,
                                      38146.85,
                                      37221.07,
                                      96260.09,
                                      42873.16,
                                      47220.00,
                                      72781.93,
                                      48498.40,
                                      40380.78,
                                      39837.12,
                                      74172.01,
                                      18317.13,
                                      30545.45,
                                    };
    [Test]
    public void Test() {
      var list = GDPPCs;
      var bound = list.Bound() ?? (0, 0);
      var scales = Aryth.Scaler.NiceLabels(bound);
      bound.Vec().Deco().Says("bound");
      scales.Deco().Says("tick labels");
      var histo = Histogram<double>.Build(scales);
      histo.Bins.Deco().Says("bins");
      histo += list;
      var pop = histo.Population;
      Console.WriteLine($">> [population] {pop}");
      foreach (var (key, vec) in histo.ToEntries()) {
        var count = vec.Count;
        var pct = (double)count / pop;
        var avg = vec.Average();
        var med = vec.Median();
        var stdDev = vec.StdDev();
        Console.WriteLine($">> [{key,16}] [count] ({count}) [percentage] ({pct:n2}) [avg] ({avg:n0}) [med] ({med:n0}) [stdDev] ({stdDev:n0})");
      }
    }
  }
}